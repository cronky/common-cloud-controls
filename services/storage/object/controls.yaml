common-controls:
  - CCC.C01  # Implement multi-factor authentication (MFA) for access to any cloud resource
  - CCC.C02  # Log all access and changes to any cloud resource
  - CCC.C03  # Prevent access to cloud resources from untrusted tenants and services
specific-controls:
  - id: CCC.ObjStor.C01
    title: Prevent access to object storage from untrusted cloud tenants and services
    objective: Ensure secure management of access to object storage resources, preventing unauthorized data access, exfiltration, and misuse of legitimate services by adversaries.
    control_family: Identity and Access Management
    threats: # WIP
      - CCC.TH01
      - CCC.TH02
      - CCC.TH03
    nist_csf:
      - PR.PT-3
      - PR.PT-4
    mitre_attack:
      - T1021
    control_mappings:
      CCM: 
        - DS-5
      ISO_27001:
        - 2013 A.13.1.3
      NIST_800_53:
        - AC-3
    test_requirements:
      01: Verify that object storage endpoint can be blocked from public access.
      02: Verify that object storage can be blocked from cloud services deployed on the same cloud tenant.
      03: Confirm that it's possible to prevent access to object storage from other cloud tenants, even if those tenants have network connectivity to the cloud tenant hosting the object storage.
  - id: CCC.ObjStor.C02
    title: Prevent deploying object storage in restricted regions
    objective: Ensure that object storage resources are not provisioned or deployed in geographic regions or cloud availability zones that have been designated as restricted or prohibited, to comply with regulatory requirements and reduce exposure to geopolitical risks.
    control_family: Data
    threats: # WIP
      - CCC.TH01
      - CCC.TH02
      - CCC.TH03
    nist_csf: 
      - PR.AC-3
      - PR.DS-5
      - RS.AN-3
    mitre_attack: 
      - T1583
    control_mappings:
      CCM: 
        - DSI-06
        - DSI-08
      ISO_27001: 
        - 2013 A.11.1.1
      NIST_800_53: 
        - AC-6
    test_requirements:
      01: Verify that object storage resources are not deployed in any of the restricted regions or cloud availability zones.
      02: Ensure that the cloud provider's configuration management tools are used to enforce restrictions on provisioning in prohibited regions.
      03: Confirm that object storage backups and copies are not allowed to be stored in restricted regions or cloud availability zones.
  - id: CCC.ObjStor.C03
    title: Prevent Requests to Object Storage Buckets or Objects with Untrusted KMS Keys
    objective: Prevent any requests to object storage buckets or objects using untrusted KMS keys to protect against unauthorized data encryption that can impact data availability and integrity.
    threats: # WIP
      - CCC.TH01
      - CCC.TH02
      - CCC.TH03
    control_family: Data
    nist_csf: PR.DS-4
    mitre_attack: T1486
    control_mappings:
      CCM: 
        - DSI-04
        - DSI-05
      ISO_27001: 
        - 2013 A.12.3.1
      NIST_800_53: 
        - CP-6
        - CP-9
    test_requirements:
      01: Verify that access policies for cloud storage buckets and objects prevent requests with untrusted KMS keys. In this case, an untrusted KMS key is one that is not specified as trusted by the cloud storage bucket owner.
  - id: CCC.ObjStor.C04
    feature_id: CCC.ObjStor.F07
    title: Prevent Replication to Untrusted Destinations
    objective: Prevent object storage replication feature from replicating data to untrusted destinations. In this case, an untrusted destination is a resource that exists outside of a specified trusted identity or network perimeter (i.e. a data perimeter).
    control_family: Data
    threats: # WIP
      - CCC.TH01
      - CCC.TH02
      - CCC.TH03
    nist_csf: PR.DS-4
    mitre_attack: T1537
    control_mappings:
      CCM: 
        - DSI-04
        - DSI-05
      ISO_27001: 
        - 2013 A.12.3.1
      NIST_800_53: 
        - CP-6
        - CP-9
    test_requirements:
      01: Verify that object storage replication configurations are prevented from replicating to untrusted destinations.
